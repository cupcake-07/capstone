<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Student Settings — Profile Settings</title>
  <link rel="stylesheet" href="css/student_v2.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <style>
    /* Page-specific layout only — rely on css/student_v2.css for sidebar styling */
    section.profile-grid {
      display: grid;
      grid-template-columns: 1fr 360px; /* main content + right hero column */
      gap: 28px;
      align-items: start;
      margin-top: 6px;
    }

    .content { width: 100%; }

    .settings-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
      align-items: start;
    }

    /* Page-local panels / forms / avatar (do NOT override .side or .page-wrapper) */
    .panel {
      background: #fff;
      padding: 18px;
      border-radius: 8px;
      box-shadow: 0 6px 20px rgba(12,16,18,0.04);
      position: relative;
      z-index: 2;
    }
    .panel h3 { margin: 0 0 12px; font-size: 18px; }
    .form-row { display:flex; flex-direction:column; gap:6px; margin-bottom:12px; }
    .form-row label { font-size:13px; color:#444; }
    .form-row input, .form-row select { padding:10px 12px; border:1px solid #e9e9e9; border-radius:8px; font-size:14px; background:#fff; }
    .actions { display:flex; gap:10px; margin-top:8px; }
    .msg { padding:10px 12px; border-radius:6px; margin-bottom:12px; display:none; }
    .msg.success { background:#e9fff0; color:#0b6b2f; border:1px solid #c9efcf; }
    .msg.error { background:#fff3f3; color:#7a1414; border:1px solid #f3caca; }

    .hero { position: static; margin: 0; }
    .avatar-wrap { display:flex; flex-direction:column; align-items:center; gap:12px; padding-top:6px; }
    .avatar-container {
      width: 300px;
      height: 300px;
      max-width: 100%;
      border-radius:12px;
      overflow:hidden;
      margin: 0 auto;
      background:#0f520c;
      display:flex; align-items:center; justify-content:center;
      box-shadow: 0 8px 0 rgba(0,0,0,0.03);
    }
    .avatar-container img.avatar { width:100%; height:100%; object-fit:cover; display:block; }

    .badge { margin-top:6px; display:inline-block; padding:6px 10px; border-radius:20px; background:#202020; color:#fff; font-size:13px; }

    @media (max-width: 1000px) {
      section.profile-grid { grid-template-columns: 1fr; }
      .settings-grid { grid-template-columns: 1fr; }
      .avatar-container { width: 220px; height:220px; }
      .panel { box-shadow: 0 4px 14px rgba(12,16,18,0.04); }
    }
  </style>
</head>
<body>
  <!-- TOP NAVBAR (same structure as student.php) -->
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-logo">GGF</div>
      <div class="navbar-text">
        <div class="navbar-title">Glorious God's Family</div>
        <div class="navbar-subtitle">Christian School</div>
      </div>
    </div>
    <div class="navbar-actions">
      <div class="user-menu">
        <span>Student</span>
        <button class="btn-icon">⋮</button>
      </div>
    </div>
  </nav>

  <div class="page-wrapper">
    <aside class="side">
      <nav class="nav">
        <a href="student.php">Profile</a>
        <a href="schedule.html">Schedule</a>
        <a href="grades.html">Grades</a>
        <a href="account.html">Account Balance</a>
        <a href="announcements.html">Announcements</a>
        <a class="active" href="student_settings.html">Settings</a>
      </nav>
      <div class="side-foot">Logged in as <strong>Student</strong></div>
    </aside>

    <main class="main">
      <header class="header">
        <h1>Settings</h1>
        <p class="muted">Manage your profile, password and account preferences.</p>
      </header>

      <section class="profile-grid">
        <div class="content">
          <div class="panel" style="margin-bottom:20px;">
            <h3>Account Settings</h3>
            <p class="muted">Quick links to update frequently used account preferences.</p>
            <div style="display:flex;gap:10px;margin-top:12px;flex-wrap:wrap;">
              <a class="btn" href="student.php">View Profile</a>
              <a class="btn ghost" href="account.html">Billing</a>
              <a class="btn ghost" href="announcements.html">Announcements</a>
            </div>
          </div>

          <div class="settings-grid">
            <!-- Left: Edit details -->
            <div class="panel">
              <h3>Edit Details</h3>
              <div id="editMsg" class="msg"></div>

              <!-- Replace action with your server endpoint -->
              <form id="editForm" method="POST" action="update_profile.php">
                <div class="form-row">
                  <label for="fullName">Full Name</label>
                  <input id="fullName" name="name" type="text" placeholder="Your full name" required />
                </div>

                <div class="form-row">
                  <label for="email">Email</label>
                  <input id="email" name="email" type="email" placeholder="you@example.com" required />
                </div>

                <div class="form-row">
                  <label for="grade">Grade Level</label>
                  <select id="grade" name="grade_level">
                    <option value="">Not Set</option>
                    <option>Grade 1</option>
                    <option>Grade 2</option>
                    <option>Grade 3</option>
                    <option>Grade 4</option>
                    <option>Grade 5</option>
                  </select>
                </div>

                <div class="form-row">
                  <label for="username">Username (optional)</label>
                  <input id="username" name="username" type="text" placeholder="username (if used)" />
                </div>

                <div class="actions">
                  <button class="btn" type="submit">Save Changes</button>
                  <button class="btn ghost" type="button" id="resetEdit">Reset</button>
                </div>
                <p class="muted" style="margin-top:10px;font-size:13px;">Note: Changes are saved to the server. If no backend is available, the page will simulate success locally.</p>
              </form>
            </div>

            <!-- Right: Change password -->
            <aside class="panel">
              <h3>Change Password</h3>
              <div id="pwMsg" class="msg"></div>

              <!-- Replace action with your server endpoint -->
              <form id="pwForm" method="POST" action="change_password.php">
                <div class="form-row">
                  <label for="currentPassword">Current Password</label>
                  <input id="currentPassword" name="current_password" type="password" required />
                </div>
                <div class="form-row">
                  <label for="newPassword">New Password</label>
                  <input id="newPassword" name="new_password" type="password" minlength="6" required />
                </div>
                <div class="form-row">
                  <label for="confirmPassword">Confirm New Password</label>
                  <input id="confirmPassword" name="confirm_password" type="password" minlength="6" required />
                </div>

                <div class="actions">
                  <button class="btn" type="submit">Change Password</button>
                  <button class="btn ghost" type="button" id="clearPw">Clear</button>
                </div>
                <p class="muted" style="margin-top:10px;font-size:13px;">Your password must be at least 6 characters. The server will validate the current password before changing it.</p>
              </form>

              <hr style="margin:14px 0;border:none;border-top:1px solid #f0f0f0;">

              <h4 style="margin:0 0 10px;">More</h4>
              <div style="display:flex;flex-direction:column;gap:8px;">
                <button class="btn ghost" id="logoutBtn">Log out</button>
                <button class="btn ghost" id="deleteAccount">Delete Account</button>
              </div>
            </aside>
          </div>
        </div>

        <!-- Right column: profile summary -->
        <aside class="hero" style="max-width:420px;">
          <div class="avatar-wrap">
            <div class="avatar-container">
              <img id="settingsAvatar" class="avatar" src="https://placehold.co/240x240/0f520c/dada18?text=Photo" alt="Student photo">
            </div>
            <div class="badge" id="settingsGrade">Grade —</div>
          </div>

          <h2 class="name" id="settingsName">Student</h2>
          <p class="role">Section A • Student ID: <strong id="settingsId">—</strong></p>

          <div class="card info">
            <div class="row">
              <div class="label">Email</div>
              <div class="value" id="settingsEmail">—</div>
            </div>
            <div class="row">
              <div class="label">Status</div>
              <div class="value status" id="settingsStatus">Not Enrolled</div>
            </div>
            <div class="row">
              <div class="label">Member Since</div>
              <div class="value">-</div>
            </div>
          </div>

          <div style="margin-top:12px;">
            <a class="btn ghost" href="student.php">Back to Profile</a>
          </div>
        </aside>
      </section>

      <footer class="footer">© <span id="year">2025</span> Schoolwide Management System</footer>
    </main>
  </div>

  <script>
    (function(){
      // demo: populate summary from localStorage or from placeholders
      const nameInput = document.getElementById('fullName');
      const emailInput = document.getElementById('email');
      const gradeSelect = document.getElementById('grade');
      const usernameInput = document.getElementById('username');

      const settingsName = document.getElementById('settingsName');
      const settingsEmail = document.getElementById('settingsEmail');
      const settingsGrade = document.getElementById('settingsGrade');
      const settingsId = document.getElementById('settingsId');

      // load saved demo data if available
      const demo = JSON.parse(localStorage.getItem('student_demo') || '{}');
      if (demo.name) nameInput.value = demo.name;
      if (demo.email) emailInput.value = demo.email;
      if (demo.grade_level) gradeSelect.value = demo.grade_level;
      if (demo.username) usernameInput.value = demo.username;
      if (demo.name) settingsName.textContent = demo.name;
      if (demo.email) settingsEmail.textContent = demo.email;
      if (demo.grade_level) settingsGrade.textContent = demo.grade_level;
      if (demo.id) settingsId.textContent = demo.id;

      // simple client-side handling for testing without backend
      const editForm = document.getElementById('editForm');
      const editMsg = document.getElementById('editMsg');
      editForm.addEventListener('submit', (e)=>{
        e.preventDefault();
        editMsg.style.display='none';
        const payload = {
          name: nameInput.value.trim(),
          email: emailInput.value.trim(),
          grade_level: gradeSelect.value,
          username: usernameInput.value.trim(),
          id: demo.id || (Math.floor(Math.random()*9000)+1000)
        };
        // basic validation
        if (!payload.name || !payload.email) {
          editMsg.textContent = 'Name and email are required.';
          editMsg.className='msg error'; editMsg.style.display='block'; return;
        }
        // simulate server success: save to localStorage and update summary
        localStorage.setItem('student_demo', JSON.stringify(payload));
        settingsName.textContent = payload.name;
        settingsEmail.textContent = payload.email;
        settingsGrade.textContent = payload.grade_level || 'Not Set';
        settingsId.textContent = payload.id;
        editMsg.textContent = 'Profile updated successfully.';
        editMsg.className='msg success'; editMsg.style.display='block';
      });

      document.getElementById('resetEdit').addEventListener('click', ()=>{
        localStorage.removeItem('student_demo');
        nameInput.value=''; emailInput.value=''; gradeSelect.value=''; usernameInput.value='';
        settingsName.textContent='Student'; settingsEmail.textContent='—'; settingsGrade.textContent='Grade —';
        settingsId.textContent='—';
        editMsg.style.display='none';
      });

      const pwForm = document.getElementById('pwForm');
      const pwMsg = document.getElementById('pwMsg');
      pwForm.addEventListener('submit', (e)=>{
        e.preventDefault();
        pwMsg.style.display='none';
        const cur = document.getElementById('currentPassword').value;
        const nw = document.getElementById('newPassword').value;
        const conf = document.getElementById('confirmPassword').value;
        if (!cur || !nw || !conf) {
          pwMsg.textContent='All fields are required.'; pwMsg.className='msg error'; pwMsg.style.display='block'; return;
        }
        if (nw.length < 6) {
          pwMsg.textContent='New password must be at least 6 characters.'; pwMsg.className='msg error'; pwMsg.style.display='block'; return;
        }
        if (nw !== conf) {
          pwMsg.textContent='New password and confirmation do not match.'; pwMsg.className='msg error'; pwMsg.style.display='block'; return;
        }
        // simulate success
        pwMsg.textContent = 'Password changed successfully (simulated).';
        pwMsg.className='msg success'; pwMsg.style.display='block';
        pwForm.reset();
      });
      document.getElementById('clearPw').addEventListener('click', ()=>{ pwForm.reset(); pwMsg.style.display='none'; });

      document.getElementById('logoutBtn').addEventListener('click', ()=>{
        // quick demo logout behavior
        alert('Log out (implement server-side logout).');
        // window.location = 'login.php';
      });
      document.getElementById('deleteAccount').addEventListener('click', ()=>{
        if (confirm('Delete account? This is irreversible.')) {
          alert('Account deletion requested (implement server-side).');
        }
      });

      const year = document.getElementById('year'); if(year) year.textContent = new Date().getFullYear();
    })();
  </script>
</body>
</html>
